table 'Time Comparison'

	/// Time comparison calculations for quarterly snapshot data. Apply to any measure to see current, prior quarter, prior year, or changes.
	calculationGroup
		precedence: 10

		/// Shows current period values as selected
		calculationItem 'Current Period' = SELECTEDMEASURE()

		/// Shows prior quarter values for comparison
		calculationItem 'Prior Quarter' =
				VAR CurrentDate = MAX('SnapshotDate_End'[Snapshot Date])
				VAR PriorQuarterDate = EDATE(CurrentDate, -3)
				RETURN
				    CALCULATE(
				        SELECTEDMEASURE(),
				        'SnapshotDate_End'[Snapshot Date] = PriorQuarterDate
				    )

		/// Shows same quarter from prior year
		calculationItem 'Prior Year' =
				VAR CurrentDate = MAX('SnapshotDate_End'[Snapshot Date])
				VAR PriorYearDate = EDATE(CurrentDate, -12)
				RETURN
				    CALCULATE(
				        SELECTEDMEASURE(),
				        'SnapshotDate_End'[Snapshot Date] = PriorYearDate
				    )

		/// Quarter-over-quarter change (current minus prior)
		calculationItem 'QoQ Change' =
				VAR CurrentValue = SELECTEDMEASURE()
				VAR CurrentDate = MAX('SnapshotDate_End'[Snapshot Date])
				VAR PriorQuarterDate = EDATE(CurrentDate, -3)
				VAR PriorValue = CALCULATE(
				    SELECTEDMEASURE(),
				    'SnapshotDate_End'[Snapshot Date] = PriorQuarterDate
				)
				RETURN
				    CurrentValue - PriorValue

		/// Year-over-year change (current minus prior year)
		calculationItem 'YoY Change' =
				VAR CurrentValue = SELECTEDMEASURE()
				VAR CurrentDate = MAX('SnapshotDate_End'[Snapshot Date])
				VAR PriorYearDate = EDATE(CurrentDate, -12)
				VAR PriorValue = CALCULATE(
				    SELECTEDMEASURE(),
				    'SnapshotDate_End'[Snapshot Date] = PriorYearDate
				)
				RETURN
				    CurrentValue - PriorValue

	column 'Time Comparison'
		dataType: string

	partition 'Partition_Time Comparison' = calculationGroup

