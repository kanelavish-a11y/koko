createOrReplace
	table 'Period Selector'
		lineageTag: 22222222-3333-4444-5555-666666666666

		calculationGroup
			precedence: 10

			calculationItem "Selected Period" = SELECTEDMEASURE()
				ordinal: 0

			calculationItem "Monthly" = 
				VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
				VAR MonthStart = EOMONTH(CurrentEndDate, -1) + 1
				RETURN
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_Start'[Snapshot Date] = MonthStart,
						'SnapshotDate_End'[Snapshot Date] = CurrentEndDate
					)
				ordinal: 1

			calculationItem "Quarterly" = 
				VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
				VAR QuarterStart = EDATE(CurrentEndDate, -3)
				RETURN
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_Start'[Snapshot Date] = QuarterStart,
						'SnapshotDate_End'[Snapshot Date] = CurrentEndDate
					)
				ordinal: 2

			calculationItem "Annual (CY)" = 
				VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
				VAR YearStart = DATE(YEAR(CurrentEndDate), 1, 1)
				RETURN
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_Start'[Snapshot Date] = YearStart,
						'SnapshotDate_End'[Snapshot Date] = CurrentEndDate
					)
				ordinal: 3

			calculationItem "Annual (FY)" = 
				VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
				VAR FYStart = 
					IF(
						MONTH(CurrentEndDate) >= 10,
						DATE(YEAR(CurrentEndDate), 10, 1),
						DATE(YEAR(CurrentEndDate) - 1, 10, 1)
					)
				RETURN
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_Start'[Snapshot Date] = FYStart,
						'SnapshotDate_End'[Snapshot Date] = CurrentEndDate
					)
				ordinal: 4

			calculationItem "Rolling 12 Months" = 
				VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
				VAR Rolling12Start = EDATE(CurrentEndDate, -12)
				RETURN
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_Start'[Snapshot Date] = Rolling12Start,
						'SnapshotDate_End'[Snapshot Date] = CurrentEndDate
					)
				ordinal: 5

			calculationItem "Rolling 6 Months" = 
				VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
				VAR Rolling6Start = EDATE(CurrentEndDate, -6)
				RETURN
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_Start'[Snapshot Date] = Rolling6Start,
						'SnapshotDate_End'[Snapshot Date] = CurrentEndDate
					)
				ordinal: 6

		column 'Period Selector'
			dataType: string
			lineageTag: aaaaaaaa-2222-3333-4444-555555555555
			summarizeBy: none
			sourceColumn: Name
			sortByColumn: Ordinal

			annotation SummarizationSetBy = Automatic

		column Ordinal
			dataType: int64
			formatString: 0
			lineageTag: bbbbbbbb-2222-3333-4444-555555555555
			summarizeBy: none
			sourceColumn: Ordinal
			isHidden

			annotation SummarizationSetBy = Automatic
