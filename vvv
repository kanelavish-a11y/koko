table 'Period Selector'
	lineageTag: 22222222-3333-4444-5555-666666666666

	calculationGroup
		precedence: 10

		calculationItem 'Selected Period' = SELECTEDMEASURE()

		calculationItem Quarterly =
			VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
			VAR CurrentEndIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentEndDate)
			VAR QuarterStartDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentEndIndex - 1)
			RETURN
				IF(
					CurrentEndIndex > 1,
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_Start'[Snapshot Date] = QuarterStartDate,
						'SnapshotDate_End'[Snapshot Date] = CurrentEndDate
					)
				)

		calculationItem 'Annual (FY)' =
			VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
			VAR CurrentFY = IF(MONTH(CurrentEndDate) >= 10, YEAR(CurrentEndDate) + 1, YEAR(CurrentEndDate))
			VAR FYStartDate =
				MINX(
					FILTER(
						ALL('SnapshotIndex'),
						VAR SnapFY = IF(MONTH('SnapshotIndex'[Snapshot Date]) >= 10, YEAR('SnapshotIndex'[Snapshot Date]) + 1, YEAR('SnapshotIndex'[Snapshot Date]))
						RETURN SnapFY = CurrentFY
					),
					'SnapshotIndex'[Snapshot Date]
				)
			RETURN
				IF(
					NOT ISBLANK(FYStartDate),
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_Start'[Snapshot Date] = FYStartDate,
						'SnapshotDate_End'[Snapshot Date] = CurrentEndDate
					)
				)

		calculationItem 'Rolling 4 Quarters' =
			VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
			VAR CurrentEndIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentEndDate)
			VAR RollingStartDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentEndIndex - 4)
			RETURN
				IF(
					CurrentEndIndex > 4,
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_Start'[Snapshot Date] = RollingStartDate,
						'SnapshotDate_End'[Snapshot Date] = CurrentEndDate
					)
				)

		calculationItem 'Rolling 2 Quarters' =
			VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
			VAR CurrentEndIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentEndDate)
			VAR RollingStartDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentEndIndex - 2)
			RETURN
				IF(
					CurrentEndIndex > 2,
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_Start'[Snapshot Date] = RollingStartDate,
						'SnapshotDate_End'[Snapshot Date] = CurrentEndDate
					)
				)

	column 'Period Selector'
		dataType: string
		lineageTag: aaaaaaaa-2222-3333-4444-555555555555
		summarizeBy: none
		sourceColumn: Name
		sortByColumn: Ordinal

	column Ordinal
		dataType: int64
		isHidden
		formatString: 0
		lineageTag: bbbbbbbb-2222-3333-4444-555555555555
		summarizeBy: none
		sourceColumn: Ordinal
