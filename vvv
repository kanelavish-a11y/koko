table 'Time Comparison'
	lineageTag: f576d66a-9d80-4a28-9e38-2aaed6f929be

	calculationGroup

		calculationItem 'Current Period' = SELECTEDMEASURE()

		calculationItem 'Prior Quarter' =
			VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
			VAR CurrentStartDate = SELECTEDVALUE('SnapshotDate_Start'[Snapshot Date])
			VAR CurrentEndIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentEndDate)
			VAR CurrentStartIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentStartDate)
			VAR PriorEndDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentEndIndex - 1)
			VAR PriorStartDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentStartIndex - 1)
			RETURN
				IF(
					CurrentEndIndex > 1 && CurrentStartIndex > 1,
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_End'[Snapshot Date] = PriorEndDate,
						'SnapshotDate_Start'[Snapshot Date] = PriorStartDate
					)
				)

		calculationItem 'Prior Year' =
			VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
			VAR CurrentStartDate = SELECTEDVALUE('SnapshotDate_Start'[Snapshot Date])
			VAR CurrentEndIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentEndDate)
			VAR CurrentStartIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentStartDate)
			VAR PriorYearEndDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentEndIndex - 4)
			VAR PriorYearStartDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentStartIndex - 4)
			RETURN
				IF(
					CurrentEndIndex > 4 && CurrentStartIndex > 4,
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_End'[Snapshot Date] = PriorYearEndDate,
						'SnapshotDate_Start'[Snapshot Date] = PriorYearStartDate
					)
				)

		calculationItem 'YoY Change' =
			VAR CurrentValue = SELECTEDMEASURE()
			VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
			VAR CurrentStartDate = SELECTEDVALUE('SnapshotDate_Start'[Snapshot Date])
			VAR CurrentEndIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentEndDate)
			VAR CurrentStartIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentStartDate)
			VAR PriorYearEndDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentEndIndex - 4)
			VAR PriorYearStartDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentStartIndex - 4)
			VAR PriorYearValue =
				IF(
					CurrentEndIndex > 4 && CurrentStartIndex > 4,
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_End'[Snapshot Date] = PriorYearEndDate,
						'SnapshotDate_Start'[Snapshot Date] = PriorYearStartDate
					)
				)
			RETURN
				IF(
					NOT ISBLANK(CurrentValue) && NOT ISBLANK(PriorYearValue),
					CurrentValue - PriorYearValue
				)

		calculationItem 'YoY % Change' =
			VAR CurrentValue = SELECTEDMEASURE()
			VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
			VAR CurrentStartDate = SELECTEDVALUE('SnapshotDate_Start'[Snapshot Date])
			VAR CurrentEndIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentEndDate)
			VAR CurrentStartIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentStartDate)
			VAR PriorYearEndDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentEndIndex - 4)
			VAR PriorYearStartDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentStartIndex - 4)
			VAR PriorYearValue =
				IF(
					CurrentEndIndex > 4 && CurrentStartIndex > 4,
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_End'[Snapshot Date] = PriorYearEndDate,
						'SnapshotDate_Start'[Snapshot Date] = PriorYearStartDate
					)
				)
			RETURN
				IF(
					NOT ISBLANK(PriorYearValue) && PriorYearValue <> 0,
					DIVIDE(CurrentValue - PriorYearValue, PriorYearValue)
				)

		calculationItem 'QoQ Change' =
			VAR CurrentValue = SELECTEDMEASURE()
			VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
			VAR CurrentStartDate = SELECTEDVALUE('SnapshotDate_Start'[Snapshot Date])
			VAR CurrentEndIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentEndDate)
			VAR CurrentStartIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentStartDate)
			VAR PriorEndDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentEndIndex - 1)
			VAR PriorStartDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentStartIndex - 1)
			VAR PriorQuarterValue =
				IF(
					CurrentEndIndex > 1 && CurrentStartIndex > 1,
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_End'[Snapshot Date] = PriorEndDate,
						'SnapshotDate_Start'[Snapshot Date] = PriorStartDate
					)
				)
			RETURN
				IF(
					NOT ISBLANK(CurrentValue) && NOT ISBLANK(PriorQuarterValue),
					CurrentValue - PriorQuarterValue
				)

		calculationItem 'QoQ % Change' =
			VAR CurrentValue = SELECTEDMEASURE()
			VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
			VAR CurrentStartDate = SELECTEDVALUE('SnapshotDate_Start'[Snapshot Date])
			VAR CurrentEndIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentEndDate)
			VAR CurrentStartIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentStartDate)
			VAR PriorEndDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentEndIndex - 1)
			VAR PriorStartDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentStartIndex - 1)
			VAR PriorQuarterValue =
				IF(
					CurrentEndIndex > 1 && CurrentStartIndex > 1,
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_End'[Snapshot Date] = PriorEndDate,
						'SnapshotDate_Start'[Snapshot Date] = PriorStartDate
					)
				)
			RETURN
				IF(
					NOT ISBLANK(PriorQuarterValue) && PriorQuarterValue <> 0,
					DIVIDE(CurrentValue - PriorQuarterValue, PriorQuarterValue)
				)

		calculationItem FYTD =
			VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
			VAR CurrentFY = IF(MONTH(CurrentEndDate) >= 10, YEAR(CurrentEndDate) + 1, YEAR(CurrentEndDate))
			VAR FYStartDate =
				MINX(
					FILTER(
						ALL('SnapshotIndex'),
						VAR SnapFY = IF(MONTH('SnapshotIndex'[Snapshot Date]) >= 10, YEAR('SnapshotIndex'[Snapshot Date]) + 1, YEAR('SnapshotIndex'[Snapshot Date]))
						RETURN SnapFY = CurrentFY
					),
					'SnapshotIndex'[Snapshot Date]
				)
			RETURN
				IF(
					NOT ISBLANK(FYStartDate),
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_Start'[Snapshot Date] = FYStartDate,
						'SnapshotDate_End'[Snapshot Date] = CurrentEndDate
					)
				)

		calculationItem 'Prior FYTD' =
			VAR CurrentEndDate = SELECTEDVALUE('SnapshotDate_End'[Snapshot Date])
			VAR CurrentFY = IF(MONTH(CurrentEndDate) >= 10, YEAR(CurrentEndDate) + 1, YEAR(CurrentEndDate))
			VAR PriorFY = CurrentFY - 1
			VAR CurrentEndIndex = LOOKUPVALUE('SnapshotIndex'[Index], 'SnapshotIndex'[Snapshot Date], CurrentEndDate)
			VAR PriorFYEndDate = LOOKUPVALUE('SnapshotIndex'[Snapshot Date], 'SnapshotIndex'[Index], CurrentEndIndex - 4)
			VAR PriorFYStartDate =
				MINX(
					FILTER(
						ALL('SnapshotIndex'),
						VAR SnapFY = IF(MONTH('SnapshotIndex'[Snapshot Date]) >= 10, YEAR('SnapshotIndex'[Snapshot Date]) + 1, YEAR('SnapshotIndex'[Snapshot Date]))
						RETURN SnapFY = PriorFY
					),
					'SnapshotIndex'[Snapshot Date]
				)
			RETURN
				IF(
					NOT ISBLANK(PriorFYStartDate) && NOT ISBLANK(PriorFYEndDate),
					CALCULATE(
						SELECTEDMEASURE(),
						'SnapshotDate_Start'[Snapshot Date] = PriorFYStartDate,
						'SnapshotDate_End'[Snapshot Date] = PriorFYEndDate
					)
				)

	column 'Time Comparison'
		dataType: string
		lineageTag: ae465c7b-154e-4558-9f19-1597d37d2d05
		summarizeBy: none
		sourceColumn: Name
		sortByColumn: Ordinal

	column Ordinal
		dataType: int64
		isHidden
		formatString: 0
		lineageTag: e03989d9-e335-4b13-b250-45197ce43d88
		summarizeBy: none
		sourceColumn: Ordinal
